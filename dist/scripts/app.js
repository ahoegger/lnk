"use strict";var lnk=lnk||{};lnk.namespace=function(e){var t,n=e.split("."),i=lnk;for("lnk"===n[0]&&(n=n.slice(1)),t=0;t<n.length;t+=1)"undefined"==typeof i[n[t]]&&(i[n[t]]={}),i=i[n[t]];return i};var lnk=lnk||{};lnk.namespace("lnk.helper"),lnk.helper=function(){function e(e,t){var i=t||n;window.console&&window.console.log&&window.console.log("["+i.toUpperCase()+"] "+e)}function t(t){window.console&&window.console.dir?window.console.dir(t):e("Unable to console.dir object"+t,"INFO")}var n="INFO";return{log:function(t,n){e(t,n)},logDebug:function(t){e(t,"DEBUG")},logInfo:function(t){e(t,"INFO")},logWarn:function(t){e(t,"WARN")},logError:function(t){e(t,"ERROR")},logFatal:function(t){e(t,"FATAL")},logDir:function(e){t(e)}}}();var lnk=lnk||{};lnk.namespace("lnk.services"),lnk.services=function(e){var t=[{id:1,title:"Jersey - RESTful Web Services in Java",description:"Developing RESTful Web services that seamlessly support exposing your data in a variety of representation media types and abstract away the low-level details of the client-server communication is not an easy task without a good toolkit. In order to simplify development of RESTful Web services and their clients in Java, a standard and portable JAX-RS API has been designed. Jersey RESTful Web Services framework is open source, production quality, framework for developing RESTful Web Services in Java that provides support for JAX-RS APIs and serves as a JAX-RS (JSR 311 & JSR 339) Reference Implementation.",url:"https://jersey.java.net/",imageUrl:"https://jersey.java.net/images/jersey_logo.png",submittedBy:"hhe",submittedOn:new Date("06/14/2014"),votes:0,tags:["Java","REST","JAX-RS"],numberOfComments:2},{id:2,title:"FasterXML/jackson",description:"Jackson is a suite of data-processing tools for Java (and JVM platform), including the flagship JSON parsing and generation library, as well as additional modules to process data encoded in Avro, CBOR, CSV, Smile, XML or YAML (and list of supported format is still growing!)",url:"https://github.com/FasterXML/jackson",imageUrl:"http://fasterxml.com/images/fxml_logo.png",submittedBy:"aho",submittedOn:new Date,votes:0,tags:["Java","JSON"],numberOfComments:2},{id:3,title:"Eclipse Scout",description:"Eclipse Scout is a mature and open framework for modern, service oriented business applications. It substantially boosts developer productivity and is simple to learn.",url:"https://www.eclipse.org/scout/",imageUrl:"http://www.bsiag.com/scout/wp-content/themes/bsi_new/images/header1.png",submittedBy:"aho",submittedOn:new Date,votes:2,tags:["Scout","Eclipse Scout","Eclipse"],numberOfComments:3}],n=[{id:1,articleId:1,text:"Comment 1 for article 1",submittedOn:new Date,submittedBy:"aho"},{id:2,articleId:1,text:"Comment 2 for article 1",submittedOn:new Date,submittedBy:"hhe"},{id:3,articleId:2,text:"Comment 1 for article 2",submittedOn:new Date,submittedBy:"hhe"},{id:4,articleId:2,text:"Comment 2 for article 2",submittedOn:new Date,submittedBy:"aho"},{id:5,articleId:3,text:"Simple: Looking for an an application framework where you really get what you see? Then you might really like to have a look at the Eclipse Scout Screencasts",submittedOn:new Date,submittedBy:"hhe"},{id:6,articleId:3,text:"Simple: Looking for an an application framework where you really get what you see? Then you might really like to have a look at the Eclipse Scout Screencasts.",submittedOn:new Date,submittedBy:"hhe"},{id:7,articleId:3,text:"Flexible: Dreaming of an application framework that combines easy learning with powerful adapting? Why don't you check out our Eclipse Scout tutorial",submittedOn:new Date,submittedBy:"hhe"}],i={},o={};return i.checkLoopProperties=function(t,n){return void 0===t||void 0===n?(e.logWarn("Searching new ID with incomplete data, dataArray="+t+", idProperty="+n),!1):!0},i.getNewId=function(t,n){var o=-1;if(i.checkLoopProperties(t,n)){for(var r=0,a=t.length;a>r;r+=1)o=(t[r][n]&&t[r][n])>o?t[r][n]:o;o+=1,e.logDebug("New max value "+o)}return o},i.findPositionById=function(t,n,o){if(i.checkLoopProperties(t,n)){for(var r=0,a=t.length;a>r;r+=1)if(t[r][n]&&t[r][n]===o)return e.logDebug("Found item with id "+o+" at position "+r),r;e.logInfo("Found no item with id "+o)}},i.filterCommentsForArticle=function(t,n,o){var r=[];if(i.checkLoopProperties(t,n)||!o){for(var a=0,s=t.length;s>a;a+=1)t[a][n]&&t[a][n]===o&&(e.logDebug("Found item with id "+o+" at position "+a),r.push(t[a]));return r}},o.getArticles=function(){return e.logDebug("Returning articles "+t),t},o.addArticle=function(e){return e.id=i.getNewId(t,"id"),t.push(e),e},o.updateArticle=function(n){var o;o=i.findPositionById(t,"id",n.id),void 0!==o?t[o]=n:e.logWarn("Article not found in cached articles. Article was "+n)},o.deleteArticle=function(n){var o;o=i.findPositionById(t,"id",n),void 0!==o?t.splice([o],1):e.logWarn("Article id "+n+" not found in cached articles.")},o.vote=function(n,o){var r=i.findPositionById(t,"id",n);void 0!==r?t[r].votes=t[r].votes+o:e.logWarn("Article not found in cached articles. ArticleId was "+n)},o.getComments=function(t){return e.logDebug("Returning comments for article "+t),i.filterCommentsForArticle(n,"articleId",t)},o.updateComment=function(t){var o;o=i.findPositionById(n,"id",t.id),void 0!==o?n[o]=t:e.logWarn("Comment not found in cached articles. Comment was "+t)},o.addComment=function(e){e.id=i.getNewId(n,"id"),n.push(e)},o.deleteComment=function(t){var o;o=i.findPositionById(n,"id",t),void 0!==o?n.splice([o],1):e.logWarn("Comment id "+t+" not found in cached comments.")},{getArticles:function(){return o.getArticles()},updateArticle:function(e){o.updateArticle(e)},addArticle:function(e){o.addArticle(e)},deleteArticle:function(e){o.deleteArticle(e)},articleVoteUp:function(e){o.vote(e,1)},articleVoteDown:function(e){o.vote(e,-1)},getComments:function(e){return o.getComments(e)},updateComment:function(e){o.updateComment(e)},addComment:function(e){o.addComment(e)},deleteComment:function(e){o.deleteComment(e)}}}(lnk.helper);var lnk=lnk||{};lnk.namespace("lnk.entities"),lnk.entities=function(){var e={Article:function(e,t,n,i,o,r,a,s,l,d){this.id=e,this.title=t,this.url=n,this.imageUrl=i,this.description=o,this.submittedBy=r,this.submittedOn=a,this.votes=s,this.tags=l,this.numberOfComments=d},Comment:function(e,t,n,i,o){this.id=e,this.articleId=t,this.text=n,this.submittedBy=i,this.submittedOn=o}};return{Article:function(t,n,i,o,r,a,s,l,d,c){return new e.Article(t,n,i,o,r,a,s,l,d,c)},Comment:function(t,n,i,o,r){return new e.Comment(t,n,i,o,r)}}}();var lnk=lnk||{};lnk.namespace("lnk.viewmodels"),lnk.viewmodels=function(e,t,n,i){function o(t,n){var i=[],o=[];return t&&e.trim(t).length>0?(i=t.split(n),e.each(i,function(t,n){o.push(e.trim(n))}),o):void 0}function r(e){var n,i=e.length,o=t.observableArray();for(n=0;i>n;n+=1)o.push(new l(e[n]));return o}function a(e){var n,i=e;return n=t.computed(function(){return i().sort(function(e,t){return e.votes()===t.votes()?0:e.votes()>t.votes()?-1:1})})}function s(r,a){var s=this;return s.targetDataSource=r,s.url=t.observable(),s.title=t.observable(),s.description=t.observable(),s.alternateImageUrl=t.observable(),s.displayAlternateImageUrl=t.observable(!1),s.tags=t.observable(),s.imageUrl=t.computed(function(){return i.logDebug("Computing Image URL again"),s.alternateImageUrl()&&e.trim(s.alternateImageUrl()).length>0?s.alternateImageUrl():s.url()}),s.imageLoadedHandler=function(){i.logDebug("image loaded handler called"),s.imageUrl()===s.url()&&(s.alternateImageUrl(null),s.displayAlternateImageUrl(!1))},s.imageLoadedErrorHandler=function(){i.logInfo("Image error loading"),s.displayAlternateImageUrl(s.url().length&&0!=s.url().length?!0:!1)},s.tagsArray=function(){return o(s.tags(),",")},s.submitArticle=function(){var e;i.logDebug("Submitting a new article."),i.logDir(s),e=lnk.entities.Article(null,s.title(),s.url(),s.imageUrl(),s.description(),"newSubmitter",new Date,0,s.tagsArray(),0),i.logDir(e),n.addArticle(e),s.reset(),s.showConfirmation()},s.showConfirmation=function(){e.notify.defaults({style:"bootstrap",className:"success",showAnimation:"fadeIn",hideAnimation:"fadeOut"}),a.notify("Successfully added .lnk. You can find it using search.",{position:"bottom right"})},s.reset=function(){s.url(""),s.title(""),s.description(""),s.alternateImageUrl(""),s.displayAlternateImageUrl(""),s.tags("")},s}function l(o){var r=this;this.article=o,e.extend(this,o),this.numberOfComments=t.observable(o.numberOfComments),this.comments=t.observableArray([]),this.displayComments=t.observable(!1),this.displayAddComment=t.observable(!1),this.toggleShowComments=function(){var t;this.displayComments(!this.displayComments()),this.displayAddComment(this.displayComments()),0===this.comments().length&&(t=n.getComments(this.id),e.each(t,function(e,t){r.comments.push(t)}),i.logDebug("Length of comments: "+this.comments.length))},this.toggleShowAddComment=function(){this.displayAddComment(!this.displayAddComment())},this.votes=t.observable(o.votes),this.voteUp=function(){this.votes(this.votes()+1),n.articleVoteUp(this.id)},this.voteDown=function(){this.votes(this.votes()-1),n.articleVoteDown(this.id)},this.tags=t.observableArray(this.tags),this.setTags=function(e){this.tags=e}.bind(this),this.setComments=function(e){this.comments=e}.bind(this),this.addComment=function(e){this.comments.push(e),this.numberOfComments(this.comments().length)}.bind(this)}return{buildObservableArticleViews:function(e){return r(e)},getSortedArticleViewModel:function(e){return a(e)},buildAddFormViewModel:function(e,t){return new s(e,t)},buildArticleViewModel:function(e){return new l(e)}}}(jQuery,ko,lnk.services,lnk.helper);var lnk=lnk||{};lnk.namespace("lnk.behaviour"),lnk.namespace("lnk.globals"),lnk.globals.articleViews=ko.observableArray(),jQuery(document).ready(function(){var e=ko.observableArray();lnk.behaviour.setObservableDataSource(e),ko.applyBindings({articles:lnk.viewmodels.getSortedArticleViewModel(e)},document.getElementById("top-results")),ko.applyBindings(lnk.viewmodels.buildAddFormViewModel(e,$("#lnk-submit")),document.getElementById("add")),ko.applyBindings(e,document.getElementById("search"))}),lnk.behaviour=function(e,t,n,i){var o=null;return console.log("ObservableDataReference:"+o),{setObservableDataSource:function(e){o=e},search:function(t){var r;i.logDebug(t),i.logDir(o()),o.removeAll(),r=lnk.viewmodels.buildObservableArticleViews(n.getArticles()),e.each(r(),function(e,t){o.push(t)}),i.logDir(o)},addComment:function(o){var r;""!=o.comment.value&&(r=lnk.entities.Comment(null,t.dataFor(o).id,o.comment.value,"newCommenter",new Date),i.logDir(r),n.addComment(r),t.dataFor(o).addComment(r),o.comment.value="",e.notify.defaults({style:"bootstrap",className:"success",showAnimation:"fadeIn",hideAnimation:"fadeOut"}),e(o).notify("Successfully added comment",{position:"bottom right"}))},autoResize:function(t,n){var i,o,r;if(i=e(n.target),!i.prop("scrollTop"))do o=i.prop("scrollHeight"),r=i.height(),i.height(r-5);while(o&&o!==i.prop("scrollHeight"));i.height(i.prop("scrollHeight")+10)}}}(jQuery,ko,lnk.services,lnk.helper);